<!DOCTYPE html>
<html>
	<head>
		<title>Toggle Test</title>
		<style>
			.test-container {
				padding: 20px;
				font-family: Arial, sans-serif;
			}
			.test-flag {
				margin: 10px;
				padding: 10px;
				border: 1px solid #ccc;
				background: #f9f9f9;
			}
			body.hide-constituency-labels
				.balloon-message[data-constituency-flag="true"] {
				display: none !important;
			}
		</style>
	</head>
	<body>
		<div class="test-container">
			<h1>Toggle Test</h1>

			<div>
				<label>
					<input type="checkbox" id="constituency-labels-toggle" checked />
					Show constituency labels
				</label>
			</div>

			<div class="test-flag">
				<div class="balloon-message" data-constituency-flag="true">
					UK Constituency Flag Test
				</div>
			</div>

			<div class="test-flag">
				<div class="balloon-message" data-constituency-flag="false">
					Country Flag Test
				</div>
			</div>

			<button onclick="testToggle()">Test Toggle</button>
			<button onclick="checkFlags()">Check All Flags</button>
		</div>

		<script>
			let showConstituencyLabels = true;

			function testToggle() {
				showConstituencyLabels = !showConstituencyLabels;
				document.getElementById("constituency-labels-toggle").checked =
					showConstituencyLabels;

				if (showConstituencyLabels) {
					document.body.classList.remove("hide-constituency-labels");
					console.log("✅ Showing constituency labels");
				} else {
					document.body.classList.add("hide-constituency-labels");
					console.log("❌ Hiding constituency labels");
				}

				// Also apply direct styles as backup
				const flags = document.querySelectorAll(
					'.balloon-message[data-constituency-flag="true"]'
				);
				flags.forEach((flag) => {
					if (showConstituencyLabels) {
						flag.style.display = "";
					} else {
						flag.style.display = "none";
					}
				});
			}

			function checkFlags() {
				const allFlags = document.querySelectorAll(".balloon-message");
				console.log(`Found ${allFlags.length} flags:`);
				allFlags.forEach((flag, i) => {
					const isConstituency =
						flag.getAttribute("data-constituency-flag") === "true";
					const display = window.getComputedStyle(flag).display;
					console.log(
						`Flag ${i}: "${flag.textContent}" constituency=${isConstituency} display=${display}`
					);
				});
			}

			// Set up toggle listener
			document
				.getElementById("constituency-labels-toggle")
				.addEventListener("change", function () {
					showConstituencyLabels = this.checked;
					testToggle();
				});
		</script>
	</body>
</html>
