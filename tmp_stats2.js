const data = [
	{ signatures: 2347065, timestamp: 1759089460000 },
	{ signatures: 2347107, timestamp: 1759089470000 },
	{ signatures: 2347151, timestamp: 1759089480000 },
	{ signatures: 2347151, timestamp: 1759089480000 },
	{ signatures: 2347205, timestamp: 1759089490000 },
	{ signatures: 2347243, timestamp: 1759089500000 },
	{ signatures: 2347284, timestamp: 1759089510000 },
	{ signatures: 2347374, timestamp: 1759089530000 },
	{ signatures: 2347413, timestamp: 1759089540000 },
	{ signatures: 2347453, timestamp: 1759089550000 },
	{ signatures: 2347488, timestamp: 1759089560000 },
	{ signatures: 2347538, timestamp: 1759089570000 },
	{ signatures: 2347593, timestamp: 1759089580000 },
	{ signatures: 2347634, timestamp: 1759089590000 },
	{ signatures: 2347663, timestamp: 1759089600000 },
	{ signatures: 2347698, timestamp: 1759089610000 },
	{ signatures: 2347740, timestamp: 1759089620000 },
	{ signatures: 2347776, timestamp: 1759089630000 },
	{ signatures: 2347821, timestamp: 1759089640000 },
	{ signatures: 2347859, timestamp: 1759089650000 },
	{ signatures: 2347897, timestamp: 1759089660000 },
	{ signatures: 2347937, timestamp: 1759089670000 },
	{ signatures: 2347980, timestamp: 1759089680000 },
	{ signatures: 2348019, timestamp: 1759089690000 },
	{ signatures: 2348061, timestamp: 1759089700000 },
	{ signatures: 2348101, timestamp: 1759089710000 },
	{ signatures: 2348153, timestamp: 1759089720000 },
	{ signatures: 2348189, timestamp: 1759089730000 },
	{ signatures: 2348238, timestamp: 1759089740000 },
	{ signatures: 2348280, timestamp: 1759089750000 },
	{ signatures: 2348316, timestamp: 1759089760000 },
	{ signatures: 2348316, timestamp: 1759089760000 },
	{ signatures: 2348352, timestamp: 1759089770000 },
	{ signatures: 2348389, timestamp: 1759089780000 },
	{ signatures: 2348437, timestamp: 1759089790000 },
	{ signatures: 2348528, timestamp: 1759089810000 },
	{ signatures: 2348569, timestamp: 1759089820000 },
	{ signatures: 2348606, timestamp: 1759089830000 },
	{ signatures: 2348647, timestamp: 1759089840000 },
	{ signatures: 2348691, timestamp: 1759089850000 },
	{ signatures: 2348740, timestamp: 1759089860000 },
	{ signatures: 2348787, timestamp: 1759089870000 },
	{ signatures: 2348832, timestamp: 1759089880000 },
	{ signatures: 2348869, timestamp: 1759089890000 },
	{ signatures: 2348896, timestamp: 1759089900000 },
	{ signatures: 2348928, timestamp: 1759089910000 },
	{ signatures: 2348966, timestamp: 1759089920000 },
	{ signatures: 2349013, timestamp: 1759089930000 },
	{ signatures: 2349051, timestamp: 1759089940000 },
	{ signatures: 2349093, timestamp: 1759089950000 },
	{ signatures: 2349131, timestamp: 1759089960000 },
	{ signatures: 2349180, timestamp: 1759089970000 },
	{ signatures: 2349211, timestamp: 1759089980000 },
	{ signatures: 2349249, timestamp: 1759089990000 },
	{ signatures: 2349295, timestamp: 1759090000000 },
	{ signatures: 2349329, timestamp: 1759090010000 },
	{ signatures: 2349369, timestamp: 1759090020000 },
	{ signatures: 2349411, timestamp: 1759090030000 },
	{ signatures: 2349462, timestamp: 1759090040000 },
	{ signatures: 2349507, timestamp: 1759090050000 },
	{ signatures: 2349550, timestamp: 1759090060000 },
	{ signatures: 2349855, timestamp: 1759090130000 },
	{ signatures: 2350072, timestamp: 1759090190000 },
	{ signatures: 2350270, timestamp: 1759090240000 },
	{ signatures: 2350554, timestamp: 1759090300000 },
	{ signatures: 2350699, timestamp: 1759090340000 },
	{ signatures: 2350699, timestamp: 1759090340000 },
	{ signatures: 2350736, timestamp: 1759090350000 },
	{ signatures: 2350785, timestamp: 1759090360000 },
	{ signatures: 2350847, timestamp: 1759090380000 },
	{ signatures: 2350887, timestamp: 1759090390000 },
	{ signatures: 2350923, timestamp: 1759090400000 },
	{ signatures: 2350962, timestamp: 1759090410000 },
	{ signatures: 2351009, timestamp: 1759090420000 },
	{ signatures: 2351059, timestamp: 1759090430000 },
	{ signatures: 2351092, timestamp: 1759090440000 },
	{ signatures: 2351139, timestamp: 1759090450000 },
	{ signatures: 2351181, timestamp: 1759090460000 },
	{ signatures: 2351218, timestamp: 1759090470000 },
	{ signatures: 2351262, timestamp: 1759090480000 },
	{ signatures: 2351308, timestamp: 1759090490000 },
	{ signatures: 2351347, timestamp: 1759090500000 },
	{ signatures: 2351386, timestamp: 1759090510000 },
	{ signatures: 2351430, timestamp: 1759090520000 },
	{ signatures: 2351472, timestamp: 1759090530000 },
	{ signatures: 2351518, timestamp: 1759090540000 },
	{ signatures: 2351555, timestamp: 1759090550000 },
	{ signatures: 2351600, timestamp: 1759090560000 },
	{ signatures: 2351633, timestamp: 1759090570000 },
	{ signatures: 2351679, timestamp: 1759090580000 },
	{ signatures: 2351719, timestamp: 1759090590000 },
	{ signatures: 2351751, timestamp: 1759090600000 },
	{ signatures: 2351751, timestamp: 1759090600000 },
	{ signatures: 2351786, timestamp: 1759090610000 },
	{ signatures: 2351832, timestamp: 1759090620000 },
	{ signatures: 2351863, timestamp: 1759090630000 },
	{ signatures: 2351934, timestamp: 1759090650000 },
	{ signatures: 2351971, timestamp: 1759090660000 },
	{ signatures: 2352012, timestamp: 1759090670000 },
	{ signatures: 2352046, timestamp: 1759090680000 },
	{ signatures: 2352087, timestamp: 1759090690000 },
	{ signatures: 2352127, timestamp: 1759090700000 },
	{ signatures: 2352184, timestamp: 1759090710000 },
	{ signatures: 2352222, timestamp: 1759090720000 },
	{ signatures: 2352252, timestamp: 1759090730000 },
	{ signatures: 2352282, timestamp: 1759090740000 },
	{ signatures: 2352330, timestamp: 1759090750000 },
	{ signatures: 2352372, timestamp: 1759090760000 },
	{ signatures: 2352426, timestamp: 1759090770000 },
	{ signatures: 2352468, timestamp: 1759090780000 },
	{ signatures: 2352504, timestamp: 1759090790000 },
	{ signatures: 2352538, timestamp: 1759090800000 },
	{ signatures: 2352573, timestamp: 1759090810000 },
	{ signatures: 2352612, timestamp: 1759090820000 },
	{ signatures: 2352651, timestamp: 1759090830000 },
	{ signatures: 2352694, timestamp: 1759090840000 },
	{ signatures: 2352728, timestamp: 1759090850000 },
	{ signatures: 2352769, timestamp: 1759090860000 },
	{ signatures: 2352797, timestamp: 1759090870000 },
	{ signatures: 2352797, timestamp: 1759090870000 },
	{ signatures: 2352842, timestamp: 1759090880000 },
	{ signatures: 2352885, timestamp: 1759090890000 },
	{ signatures: 2352925, timestamp: 1759090900000 },
	{ signatures: 2353004, timestamp: 1759090920000 },
	{ signatures: 2353046, timestamp: 1759090930000 },
	{ signatures: 2353088, timestamp: 1759090940000 },
	{ signatures: 2353127, timestamp: 1759090950000 },
	{ signatures: 2353161, timestamp: 1759090960000 },
	{ signatures: 2353203, timestamp: 1759090970000 },
	{ signatures: 2353251, timestamp: 1759090980000 },
	{ signatures: 2353280, timestamp: 1759090990000 },
	{ signatures: 2353324, timestamp: 1759091000000 },
	{ signatures: 2353369, timestamp: 1759091010000 },
	{ signatures: 2353406, timestamp: 1759091020000 },
	{ signatures: 2353434, timestamp: 1759091030000 },
	{ signatures: 2353466, timestamp: 1759091040000 },
	{ signatures: 2353529, timestamp: 1759091050000 },
	{ signatures: 2353565, timestamp: 1759091060000 },
	{ signatures: 2353600, timestamp: 1759091070000 },
	{ signatures: 2353644, timestamp: 1759091080000 },
	{ signatures: 2353692, timestamp: 1759091090000 },
	{ signatures: 2353734, timestamp: 1759091100000 },
	{ signatures: 2353766, timestamp: 1759091110000 },
	{ signatures: 2353808, timestamp: 1759091120000 },
	{ signatures: 2353847, timestamp: 1759091130000 },
	{ signatures: 2353847, timestamp: 1759091130000 },
	{ signatures: 2353876, timestamp: 1759091140000 },
	{ signatures: 2353929, timestamp: 1759091150000 },
	{ signatures: 2353969, timestamp: 1759091160000 },
	{ signatures: 2354062, timestamp: 1759091180000 },
	{ signatures: 2354105, timestamp: 1759091190000 },
	{ signatures: 2354148, timestamp: 1759091200000 },
	{ signatures: 2354190, timestamp: 1759091210000 },
	{ signatures: 2354246, timestamp: 1759091220000 },
	{ signatures: 2354296, timestamp: 1759091230000 },
	{ signatures: 2354328, timestamp: 1759091240000 },
	{ signatures: 2354361, timestamp: 1759091250000 },
	{ signatures: 2354408, timestamp: 1759091260000 },
	{ signatures: 2354452, timestamp: 1759091270000 },
	{ signatures: 2354499, timestamp: 1759091280000 },
	{ signatures: 2354532, timestamp: 1759091290000 },
	{ signatures: 2354568, timestamp: 1759091300000 },
	{ signatures: 2354615, timestamp: 1759091310000 },
	{ signatures: 2354656, timestamp: 1759091320000 },
	{ signatures: 2354708, timestamp: 1759091330000 },
	{ signatures: 2354743, timestamp: 1759091340000 },
	{ signatures: 2354803, timestamp: 1759091350000 },
	{ signatures: 2354833, timestamp: 1759091360000 },
	{ signatures: 2354888, timestamp: 1759091370000 },
	{ signatures: 2354929, timestamp: 1759091380000 },
	{ signatures: 2354984, timestamp: 1759091390000 },
	{ signatures: 2355019, timestamp: 1759091400000 },
	{ signatures: 2355019, timestamp: 1759091400000 },
	{ signatures: 2355050, timestamp: 1759091410000 },
	{ signatures: 2355092, timestamp: 1759091420000 },
	{ signatures: 2355133, timestamp: 1759091430000 },
	{ signatures: 2355195, timestamp: 1759091450000 },
	{ signatures: 2355234, timestamp: 1759091460000 },
	{ signatures: 2355286, timestamp: 1759091470000 },
	{ signatures: 2355330, timestamp: 1759091480000 },
	{ signatures: 2355370, timestamp: 1759091490000 },
	{ signatures: 2355407, timestamp: 1759091500000 },
	{ signatures: 2355448, timestamp: 1759091510000 },
	{ signatures: 2355484, timestamp: 1759091520000 },
	{ signatures: 2355539, timestamp: 1759091530000 },
	{ signatures: 2355588, timestamp: 1759091540000 },
	{ signatures: 2355639, timestamp: 1759091550000 },
	{ signatures: 2355684, timestamp: 1759091560000 },
	{ signatures: 2355725, timestamp: 1759091570000 },
	{ signatures: 2355762, timestamp: 1759091580000 },
	{ signatures: 2355806, timestamp: 1759091590000 },
	{ signatures: 2355856, timestamp: 1759091600000 },
	{ signatures: 2355894, timestamp: 1759091610000 },
	{ signatures: 2355931, timestamp: 1759091620000 },
	{ signatures: 2355973, timestamp: 1759091630000 },
	{ signatures: 2356018, timestamp: 1759091640000 },
	{ signatures: 2356059, timestamp: 1759091650000 },
	{ signatures: 2356105, timestamp: 1759091660000 },
	{ signatures: 2356152, timestamp: 1759091670000 },
	{ signatures: 2356198, timestamp: 1759091680000 },
	{ signatures: 2356235, timestamp: 1759091690000 },
	{ signatures: 2356325, timestamp: 1759091710000 },
	{ signatures: 2356371, timestamp: 1759091720000 },
	{ signatures: 2356421, timestamp: 1759091730000 },
	{ signatures: 2356458, timestamp: 1759091740000 },
	{ signatures: 2356505, timestamp: 1759091750000 },
	{ signatures: 2356546, timestamp: 1759091760000 },
	{ signatures: 2356593, timestamp: 1759091770000 },
	{ signatures: 2356648, timestamp: 1759091780000 },
	{ signatures: 2356683, timestamp: 1759091790000 },
	{ signatures: 2356735, timestamp: 1759091800000 },
	{ signatures: 2356776, timestamp: 1759091810000 },
	{ signatures: 2356819, timestamp: 1759091820000 },
	{ signatures: 2356854, timestamp: 1759091830000 },
	{ signatures: 2356900, timestamp: 1759091840000 },
	{ signatures: 2356943, timestamp: 1759091850000 },
	{ signatures: 2356989, timestamp: 1759091860000 },
	{ signatures: 2357039, timestamp: 1759091870000 },
	{ signatures: 2357085, timestamp: 1759091880000 },
	{ signatures: 2357124, timestamp: 1759091890000 },
	{ signatures: 2357158, timestamp: 1759091900000 },
	{ signatures: 2357205, timestamp: 1759091910000 },
	{ signatures: 2357254, timestamp: 1759091920000 },
	{ signatures: 2357299, timestamp: 1759091930000 },
	{ signatures: 2357339, timestamp: 1759091940000 },
	{ signatures: 2357383, timestamp: 1759091950000 },
	{ signatures: 2357430, timestamp: 1759091960000 },
	{ signatures: 2357522, timestamp: 1759091980000 },
	{ signatures: 2357556, timestamp: 1759091990000 },
	{ signatures: 2357603, timestamp: 1759092000000 },
	{ signatures: 2357647, timestamp: 1759092010000 },
	{ signatures: 2357682, timestamp: 1759092020000 },
	{ signatures: 2357731, timestamp: 1759092030000 },
	{ signatures: 2357781, timestamp: 1759092040000 },
	{ signatures: 2357824, timestamp: 1759092050000 },
	{ signatures: 2357859, timestamp: 1759092060000 },
	{ signatures: 2357901, timestamp: 1759092070000 },
	{ signatures: 2357949, timestamp: 1759092080000 },
	{ signatures: 2357984, timestamp: 1759092090000 },
	{ signatures: 2358011, timestamp: 1759092100000 },
	{ signatures: 2358051, timestamp: 1759092110000 },
	{ signatures: 2358084, timestamp: 1759092120000 },
	{ signatures: 2358117, timestamp: 1759092130000 },
	{ signatures: 2358149, timestamp: 1759092140000 },
	{ signatures: 2358187, timestamp: 1759092150000 },
	{ signatures: 2358233, timestamp: 1759092160000 },
	{ signatures: 2358270, timestamp: 1759092170000 },
	{ signatures: 2358309, timestamp: 1759092180000 },
	{ signatures: 2358354, timestamp: 1759092190000 },
	{ signatures: 2358398, timestamp: 1759092200000 },
	{ signatures: 2358447, timestamp: 1759092210000 },
	{ signatures: 2358496, timestamp: 1759092220000 },
	{ signatures: 2358531, timestamp: 1759092230000 },
	{ signatures: 2358574, timestamp: 1759092240000 },
	{ signatures: 2358622, timestamp: 1759092250000 },
	{ signatures: 2358654, timestamp: 1759092260000 },
	{ signatures: 2358741, timestamp: 1759092280000 },
	{ signatures: 2358788, timestamp: 1759092290000 },
	{ signatures: 2358836, timestamp: 1759092300000 },
	{ signatures: 2358872, timestamp: 1759092310000 },
	{ signatures: 2358906, timestamp: 1759092320000 },
	{ signatures: 2358947, timestamp: 1759092330000 },
	{ signatures: 2358989, timestamp: 1759092340000 },
	{ signatures: 2359032, timestamp: 1759092350000 },
	{ signatures: 2359065, timestamp: 1759092360000 },
	{ signatures: 2359094, timestamp: 1759092370000 },
	{ signatures: 2359144, timestamp: 1759092380000 },
	{ signatures: 2359182, timestamp: 1759092390000 },
	{ signatures: 2359223, timestamp: 1759092400000 },
	{ signatures: 2359269, timestamp: 1759092410000 },
	{ signatures: 2359300, timestamp: 1759092420000 },
	{ signatures: 2359345, timestamp: 1759092430000 },
	{ signatures: 2359389, timestamp: 1759092440000 },
	{ signatures: 2359434, timestamp: 1759092450000 },
	{ signatures: 2359479, timestamp: 1759092460000 },
	{ signatures: 2359524, timestamp: 1759092470000 },
	{ signatures: 2359572, timestamp: 1759092480000 },
	{ signatures: 2359607, timestamp: 1759092490000 },
	{ signatures: 2359656, timestamp: 1759092500000 },
	{ signatures: 2359709, timestamp: 1759092510000 },
	{ signatures: 2359741, timestamp: 1759092520000 },
	{ signatures: 2359788, timestamp: 1759092530000 },
	{ signatures: 2359836, timestamp: 1759092540000 },
	{ signatures: 2359924, timestamp: 1759092560000 },
	{ signatures: 2359972, timestamp: 1759092570000 },
	{ signatures: 2360009, timestamp: 1759092580000 },
	{ signatures: 2360057, timestamp: 1759092590000 },
	{ signatures: 2360111, timestamp: 1759092600000 },
	{ signatures: 2360149, timestamp: 1759092610000 },
	{ signatures: 2360199, timestamp: 1759092620000 },
	{ signatures: 2360247, timestamp: 1759092630000 },
	{ signatures: 2360284, timestamp: 1759092640000 },
	{ signatures: 2360336, timestamp: 1759092650000 },
	{ signatures: 2360393, timestamp: 1759092660000 },
	{ signatures: 2360429, timestamp: 1759092670000 },
	{ signatures: 2360469, timestamp: 1759092680000 },
	{ signatures: 2360512, timestamp: 1759092690000 },
	{ signatures: 2360558, timestamp: 1759092700000 },
	{ signatures: 2360595, timestamp: 1759092710000 },
	{ signatures: 2360635, timestamp: 1759092720000 },
	{ signatures: 2360671, timestamp: 1759092730000 },
	{ signatures: 2360708, timestamp: 1759092740000 },
];

function computeStats(data) {
	const cleaned = [];
	for (let i = 0; i < data.length; i++) {
		const cur = data[i];
		const prev = cleaned.length ? cleaned[cleaned.length - 1] : null;
		if (prev && prev.timestamp === cur.timestamp) {
			prev.signatures = Math.max(prev.signatures, cur.signatures);
		} else {
			cleaned.push({ signatures: cur.signatures, timestamp: cur.timestamp });
		}
	}
	const deltas = [];
	const intervals = [];
	for (let i = 1; i < cleaned.length; i++) {
		deltas.push(cleaned[i].signatures - cleaned[i - 1].signatures);
		intervals.push(cleaned[i].timestamp - cleaned[i - 1].timestamp);
	}
	const n = deltas.length;
	const sum = deltas.reduce((a, b) => a + b, 0);
	const mean = sum / n;
	const variance = deltas.reduce((a, b) => a + Math.pow(b - mean, 2), 0) / n;
	const stddev = Math.sqrt(variance);
	const sorted = deltas.slice().sort((a, b) => a - b);
	const min = sorted[0];
	const max = sorted[sorted.length - 1];
	const median =
		sorted.length % 2 === 1
			? sorted[(sorted.length - 1) / 2]
			: (sorted[sorted.length / 2 - 1] + sorted[sorted.length / 2]) / 2;
	const intervalSet = Array.from(new Set(intervals)).sort((a, b) => a - b);
	const histogram = {};
	for (const d of deltas) histogram[d] = (histogram[d] || 0) + 1;
	return {
		count: n,
		mean,
		stddev,
		min,
		max,
		median,
		intervalSet,
		histogram,
		lastDeltas: deltas.slice(-20),
	};
}

console.log(JSON.stringify(computeStats(data), null, 2));
